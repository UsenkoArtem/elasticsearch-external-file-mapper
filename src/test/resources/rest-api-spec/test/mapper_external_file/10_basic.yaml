---
"Mapper ExternalFile":
- do:
    indices.create:
      index: test
      body:
        mappings:
          type1:
            properties:
              name:
                type: text
              price:
                type: double
              ext_price:
                type: external_file

- do:
    index:
      index: test
      type: type1
      id: 1
      body:
        name: "Hello from external file!"

- do:
    index:
      index: test
      type: type1
      id: 3
      body:
        name: "Bye-bye"

- do:
    index:
      index: test
      type: type1
      id: 2
      body:
        name: "Good morning"

- do:
    index:
      index: test
      type: type1
      id: 4
      body:
        name: "Hey Jude"

- do:
    indices.refresh: {}

- do:
    search:
      body:
        query:
          function_score:
            field_value_factor:
              field: ext_price
              missing: 0

- match:
    hits.total: 4
- match:
    hits.hits.0._id: "3"
- match:
    hits.hits.1._id: "2"
- match:
    hits.hits.2._id: "1"
- match:
    hits.hits.3._id: "4"
# FIXME if you can
- match:
    hits.hits.0._score: 1.3
- match:
    hits.hits.1._score: 1.2
- match:
    hits.hits.2._score: 1.1
- match:
    hits.hits.3._score: 0.0
